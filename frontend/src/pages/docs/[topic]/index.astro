---
import ListLayout from '../../layouts/ListLayout.astro';
import PostItem from '../../components/PostItem.astro';
import { getSectionBySlug } from '../../lib/sections';
import { getTopicBySlug, getContentForTopic } from '../../lib/content';

export async function getStaticPaths() {
  const { getTopicsForSection } = await import('../../lib/content');
  const topics = getTopicsForSection('docs');
  
  return topics.map(topic => ({
    params: { topic: topic.slug }
  }));
}

const { topic: topicSlug } = Astro.params;
const section = getSectionBySlug('docs');
const topic = getTopicBySlug('docs', topicSlug!);
const docs = getContentForTopic('docs', topicSlug!);

if (!topic) {
  return Astro.redirect('/404');
}
---

<ListLayout title={topic.name} description={topic.description}>
  <ul class="post-list">
    {docs.map(doc => (
      <PostItem 
        title={doc.title} 
        href={`/docs/${topicSlug}/${doc.slug}`}
        readingTime={doc.readingTime}
      />
    ))}
  </ul>
  
  <a href="/docs" class="back-link">‚Üê Back to all topics</a>
</ListLayout>

<style>
  .post-list {
    margin-bottom: var(--space-xl);
  }
  
  .back-link {
    display: inline-block;
    font-size: 0.875rem;
    color: var(--color-text-muted);
    padding-top: var(--space-lg);
    border-top: 1px solid var(--color-border);
    width: 100%;
  }
  
  .back-link:hover {
    color: var(--color-accent);
  }
</style>