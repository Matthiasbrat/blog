---
import BaseLayout from '../../layouts/BaseLayout.astro';
import TopicCard from '../../components/TopicCard.astro';
import { getSectionBySlug } from '../../lib/sections';
import { getTopicsForSection, getContentForTopic } from '../../lib/content';

const section = getSectionBySlug('blog');
const topics = getTopicsForSection('blog');
---

<BaseLayout title="Blog" description={section?.description}>
  <header>
    <h1>Blog</h1>
    <p class="description">{section?.description}</p>
  </header>
  
  <section>
    <h2>Topics</h2>
    <ul class="topic-list">
      {topics.map(topic => {
        const posts = getContentForTopic('blog', topic.slug);
        return (
          <TopicCard
            title={topic.name}
            description={topic.description}
            href={`/blog/${topic.slug}`}
            count={posts.length}
          />
        );
      })}
    </ul>
  </section>
</BaseLayout>

<style>
  .description {
    font-size: 1.125rem;
    color: var(--color-text-light);
    margin-top: calc(var(--space-xl) * -1 + var(--space-md));
    margin-bottom: var(--space-2xl);
  }
  
  section h2 {
    margin-top: 0;
  }
</style>
