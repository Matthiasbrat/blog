---
import GridLayout from '../../layouts/GridLayout.astro';
import TopicCard from '../../components/TopicCard.astro';
import { getSectionBySlug } from '../../lib/sections';
import { getTopicsForSection, getContentForTopic } from '../../lib/content';

const section = getSectionBySlug('blog');
const topics = getTopicsForSection('blog');

if (!section) {
  return Astro.redirect('/404');
}
---

<GridLayout title={section.name} description={section.description}>
  {topics.map(topic => {
    const posts = getContentForTopic('blog', topic.slug);
    return (
      <TopicCard
        title={topic.name}
        description={topic.description}
        href={`/blog/${topic.slug}`}
        banner={topic.banner}
        meta={`${posts.length} posts`}
      />
    );
  })}
</GridLayout>