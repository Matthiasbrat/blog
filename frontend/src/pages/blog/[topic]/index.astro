---
import BaseLayout from '../../../layouts/ListLayout.astro';
import PostItem from '../../../components/PostItem.astro';
import { getTopicBySlug, getContentForTopic } from '../../../lib/content';

export async function getStaticPaths() {
  const { getTopicsForSection } = await import('../../../lib/content');
  const topics = getTopicsForSection('blog');
  
  return topics.map(topic => ({
    params: { topic: topic.slug }
  }));
}

const { topic: topicSlug } = Astro.params;
const topic = getTopicBySlug('blog', topicSlug!);
const posts = getContentForTopic('blog', topicSlug!);
---

<BaseLayout title={topic?.name || topicSlug} description={topic?.description}>
  <ul class="posts">
    {posts.map(post => (
      <PostItem 
        title={post.title} 
        href={`/blog/${topicSlug}/${post.slug}`}
        date={post.date}
      />
    ))}
  </ul>
  
  <p class="back"><a href="/blog">‚Üê All topics</a></p>
</BaseLayout>

<style>
  .posts {
    margin-bottom: var(--space-xl);
  }
  
  .back {
    font-size: 0.9375rem;
  }
  
  .back a {
    color: var(--color-text-muted);
  }
</style>
