---
import BaseLayout from './BaseLayout.astro';
import Comments from '../components/features/Comments.astro';

interface Props {
  title: string;
  description?: string;
  updated?: Date;
  showComments?: boolean;
  showPrevNext?: boolean;
  prevPost?: { title: string; href: string };
  nextPost?: { title: string; href: string };
}

const {
  title,
  description,
  updated,
  showComments = true,
  showPrevNext = true,
  prevPost,
  nextPost,
} = Astro.props;

function formatDate(d: Date): string {
  return d.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<BaseLayout 
  title={title} 
  description={description}
  article={true}
  updatedDate={updated}
>
  <article>
    <header class="doc-header">
      <h1>{title}</h1>
      {updated && (
        <p class="meta">Last updated: {formatDate(updated)}</p>
      )}
    </header>
    
    <div class="content">
      <slot />
    </div>
    
    {showPrevNext && (prevPost || nextPost) && (
      <nav class="prev-next">
        {prevPost && (
          <a href={prevPost.href} class="prev">← {prevPost.title}</a>
        )}
        {nextPost && (
          <a href={nextPost.href} class="next">{nextPost.title} →</a>
        )}
      </nav>
    )}
    
    {showComments && <Comments />}
  </article>
</BaseLayout>

<style>
  .doc-header {
    margin-bottom: var(--space-xl);
  }
  
  .meta {
    font-size: 0.9375rem;
    color: var(--color-text-muted);
    margin-top: var(--space-sm);
  }
  
  .content :global(h2) {
    margin-top: var(--space-xl);
    margin-bottom: var(--space-md);
    border-bottom: 1px solid var(--color-border);
    padding-bottom: var(--space-xs);
  }
  
  .content :global(h3) {
    margin-top: var(--space-lg);
    margin-bottom: var(--space-sm);
  }
  
  .content :global(ul),
  .content :global(ol) {
    margin-bottom: var(--space-md);
    padding-left: var(--space-lg);
  }
  
  .content :global(ul) {
    list-style: disc;
  }
  
  .content :global(ol) {
    list-style: decimal;
  }
  
  .content :global(li) {
    margin-bottom: var(--space-xs);
  }
  
  .prev-next {
    display: flex;
    justify-content: space-between;
    margin-top: var(--space-xl);
    padding-top: var(--space-lg);
    border-top: 1px solid var(--color-border);
    font-size: 0.9375rem;
  }
  
  .prev-next a {
    color: var(--color-text-muted);
  }
  
  .next {
    margin-left: auto;
  }
</style>
