---
import BaseLayout from './BaseLayout.astro';
import Comments from '../components/features/Comments.astro';

interface Props {
  title: string;
  description?: string;
  date?: Date;
  updated?: Date;
  showComments?: boolean;
  showDate?: boolean;
}

const {
  title,
  description,
  date,
  updated,
  showComments = false,
  showDate = true,
} = Astro.props;

function formatDate(d: Date): string {
  return d.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}
---

<BaseLayout 
  title={title} 
  description={description}
  article={true}
  publishDate={date}
  updatedDate={updated}
>
  <article>
    <header class="article-header">
      <h1>{title}</h1>
      {showDate && date && (
        <p class="meta">
          <time datetime={date.toISOString()}>{formatDate(date)}</time>
          {updated && updated.getTime() !== date?.getTime() && (
            <span> Â· Updated {formatDate(updated)}</span>
          )}
        </p>
      )}
    </header>
    
    <div class="content">
      <slot />
    </div>
    
    {showComments && <Comments />}
  </article>
</BaseLayout>

<style>
  .article-header {
    margin-bottom: var(--space-xl);
  }
  
  .meta {
    font-size: 0.9375rem;
    color: var(--color-text-muted);
    margin-top: var(--space-sm);
  }
  
  .content :global(h2) {
    margin-top: var(--space-xl);
    margin-bottom: var(--space-md);
    border-bottom: 1px solid var(--color-border);
    padding-bottom: var(--space-xs);
  }
  
  .content :global(h3) {
    margin-top: var(--space-lg);
    margin-bottom: var(--space-sm);
  }
  
  .content :global(ul),
  .content :global(ol) {
    margin-bottom: var(--space-md);
    padding-left: var(--space-lg);
  }
  
  .content :global(ul) {
    list-style: disc;
  }
  
  .content :global(ol) {
    list-style: decimal;
  }
  
  .content :global(li) {
    margin-bottom: var(--space-xs);
  }
</style>
